<h2>Información detallada del usuario "{{ id }}"</h2>

<ng-container *ngIf="isLoading || !data; else userInfo">
    <div class="loading__section">
        <mat-spinner *ngIf="isLoading"></mat-spinner>
    </div>
</ng-container>

<ng-template #userInfo>
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form__data">
            <section>
                <h4>Datos de acceso</h4>
                <div class="form-group">
                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="person"></mat-icon>
                            <label for="accessId">Id de Acceso</label>
                        </div>
                        <input matInput formControlName="accessId" id="accessId">
                        <span error-msg [message]="controlError(form, 'accessId')"
                            [invalid]="isInvalidField(form, 'accessId')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="person"></mat-icon>
                            <label for="userName">Nombre</label>
                        </div>
                        <input matInput formControlName="userName" id="userName"
                            [ngClass]="{'input-error': getControl(form, 'userName')!.touched && getControl(form, 'userName')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userName')"
                            [invalid]="isInvalidField(form, 'userName')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="mail"></mat-icon>
                            <label for="windowsUserId">Nombre de Usuario Windows</label>
                        </div>
                        <input matInput formControlName="windowsUserId" id="windowsUserId"
                            [ngClass]="{'input-error': getControl(form, 'windowsUserId')!.touched && getControl(form, 'windowsUserId')!.invalid}">
                        <span error-msg [message]="controlError(form, 'windowsUserId')"
                            [invalid]="isInvalidField(form, 'windowsUserId')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="mail"></mat-icon>
                            <label for="emailAddress">Dirección de Correo</label>
                        </div>
                        <input matInput formControlName="emailAddress" id="emailAddress"
                            [ngClass]="{'input-error': getControl(form, 'emailAddress')!.touched && getControl(form, 'emailAddress')!.invalid}">
                        <span error-msg [message]="controlError(form, 'emailAddress')"
                            [invalid]="isInvalidField(form, 'emailAddress')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="assignment_ind"></mat-icon>
                            <label for="userType">Tipo de usuario</label>
                        </div>
                        <input matInput formControlName="userType" id="userType"
                            [ngClass]="{'input-error': getControl(form, 'userType')!.touched && getControl(form, 'userType')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userType')"
                            [invalid]="isInvalidField(form, 'userType')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="admin_panel_settings"></mat-icon>
                            <label for="profileId">Perfil</label>
                        </div>
                        <mat-select formControlName="profileId" id="profileId" class="form__select">
                            <mat-option *ngFor="let profile of profilesInfo"
                                [value]="profile.id">{{ profile.profileName }}</mat-option>
                        </mat-select>
                        <span error-msg [message]="controlError(form, 'profileId')"
                            [invalid]="isInvalidField(form, 'profileId')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="verified_user"></mat-icon>
                            <label for="userStatus">Estado</label>
                        </div>
                        <mat-slide-toggle color="accent" formControlName="userStatus" labelPosition="before"
                            id="userStatus">
                            ¿El usuario está activo? {{ userStatus ? 'SI' : 'NO' }}:
                        </mat-slide-toggle>
                        <span error-msg [message]="controlError(form, 'userStatus')"
                            [invalid]="isInvalidField(form, 'userStatus')"></span>
                    </div>
                </div>
            </section>

            <section>
                <h4>Datos de ubicación</h4>
                <div class="form-group">
                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="public"></mat-icon>
                            <label for="userCountry">País</label>
                        </div>
                        <input matInput formControlName="userCountry" id="userCountry"
                            [ngClass]="{'input-error': getControl(form, 'userCountry')!.touched && getControl(form, 'userCountry')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userCountry')"
                            [invalid]="isInvalidField(form, 'userCountry')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="person_pin_circle"></mat-icon>
                            <label for="userLocation">Ubicación</label>
                        </div>
                        <input matInput formControlName="userLocation" id="userLocation"
                            [ngClass]="{'input-error': getControl(form, 'userLocation')!.touched && getControl(form, 'userLocation')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userLocation')"
                            [invalid]="isInvalidField(form, 'userLocation')"></span>
                    </div>
                </div>
            </section>

            <section>
                <h4>Información de Logon</h4>
                <div class="form-group">
                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="badge"></mat-icon>
                            <label for="userLogonType">Tipo de ingreso</label>
                        </div>
                        <input matInput formControlName="userLogonType" id="userLogonType"
                            [ngClass]="{'input-error': getControl(form, 'userLogonType')!.touched && getControl(form, 'userLogonType')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userLogonType')"
                            [invalid]="isInvalidField(form, 'userLogonType')"></span>
                    </div>

                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="event_available"></mat-icon>
                            <label for="userLastLogonDt">Última fecha de ingreso</label>
                        </div>
                        <input matInput formControlName="userLastLogonDt" id="userLastLogonDt"
                            [ngClass]="{'input-error': getControl(form, 'userLastLogonDt')!.touched && getControl(form, 'userLastLogonDt')!.invalid}">
                        <span error-msg [message]="controlError(form, 'userLastLogonDt')"
                            [invalid]="isInvalidField(form, 'userLastLogonDt')"></span>
                    </div>
                    <div class="form-control">
                        <div class="label">
                            <mat-icon class="opacity_icon" fontIcon="badge"></mat-icon>
                            <label for="userLogonStatus">Estado de ingreso</label>
                        </div>
                        <input matInput formControlName="userLogonStatus" id="userLogonStatus">
                        <span error-msg [message]="controlError(form, 'userLogonStatus')"
                            [invalid]="isInvalidField(form, 'userLogonStatus')"></span>
                    </div>
                </div>
            </section>

            <app-control-dates-form [createdAt]="data!.createdAt" [updatedAt]="data!.updatedAt"
                [deletedAt]="data?.deletedAt" />
        </div>

        <ng-container *ngIf="isAdminUser">
            <section class="form__actions">
                <button mat-raised-button color="primary" [disabled]="!isDataChanged">
                    Actualizar Usuario de la Compañía
                </button>
                <button type="button" (click)="onRestartForm()" mat-raised-button color="accent"
                    [disabled]="!isDataChanged">
                    Restaurar Formulario
                </button>
            </section>
        </ng-container>
    </form>


</ng-template>